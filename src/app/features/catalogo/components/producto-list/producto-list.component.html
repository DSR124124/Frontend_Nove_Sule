<div class="producto-list-container">
  <!-- Header con acciones -->
  <div class="list-header">
    <div class="header-left">
      <h2>Lista de Productos</h2>
      <span class="total-count">{{totalElements}} productos</span>
    </div>
    <div class="header-actions">
      <button
        type="button"
        (click)="onRefresh()"
        class="btn btn-outline-primary"
        [disabled]="loading">
        <i class="fas fa-sync-alt" [class.fa-spin]="loading"></i> Actualizar
      </button>
      <a
        routerLink="/catalogo/productos/nuevo"
        class="btn btn-primary">
        <i class="fas fa-plus"></i> Nuevo Producto
      </a>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filters-grid">
      <div class="filter-group">
        <label for="nombre">Nombre:</label>
        <input
          type="text"
          id="nombre"
          [(ngModel)]="filtros.nombre"
          placeholder="Buscar por nombre"
          class="form-control">
      </div>

      <div class="filter-group">
        <label for="codigo">Código:</label>
        <input
          type="text"
          id="codigo"
          [(ngModel)]="filtros.codigo"
          placeholder="Buscar por código"
          class="form-control">
      </div>

      <div class="filter-group">
        <label for="estado">Estado:</label>
        <select
          id="estado"
          [(ngModel)]="filtros.estado"
          class="form-control">
          <option value="">Todos</option>
          <option value="ACTIVO">Activo</option>
          <option value="INACTIVO">Inactivo</option>
          <option value="ELIMINADO">Eliminado</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="pageSize">Por página:</label>
        <select
          id="pageSize"
          [(ngModel)]="pageSize"
          (ngModelChange)="onPageSizeChange($event)"
          class="form-control">
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </div>
    </div>

    <div class="filter-actions">
      <button
        type="button"
        (click)="onFiltrar()"
        class="btn btn-primary">
        <i class="fas fa-search"></i> Filtrar
      </button>
      <button
        type="button"
        (click)="onLimpiarFiltros()"
        class="btn btn-secondary">
        <i class="fas fa-times"></i> Limpiar
      </button>
    </div>
  </div>

  <!-- Error message -->
  <div class="error-message" *ngIf="error">
    <div class="alert alert-danger">
      <i class="fas fa-exclamation-circle"></i> {{error}}
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Cargando productos...</p>
  </div>

  <!-- Lista de productos -->
  <div class="productos-grid" *ngIf="!loading && productos.length > 0">
    <div
      *ngFor="let producto of productos"
      class="producto-card"
      [routerLink]="['/catalogo/productos/editar', producto.id]">

      <!-- Header del producto -->
      <div class="producto-header">
        <div class="producto-title">
          <h3>{{producto.nombre}}</h3>
          <span class="codigo">{{producto.codigo}}</span>
        </div>
        <div class="producto-status">
          <span
            class="estado-badge"
            [ngClass]="getEstadoClass(producto.estado)">
            {{producto.estado}}
          </span>
        </div>
      </div>

      <!-- Imagen del producto (placeholder) -->
      <div class="producto-image">
        <div class="image-placeholder">
          <i class="fas fa-box"></i>
        </div>
      </div>

      <!-- Información del producto -->
      <div class="producto-info">
        <div class="info-row">
          <span class="label">Descripción:</span>
          <span class="value">{{producto.descripcion || 'Sin descripción'}}</span>
        </div>

        <div class="info-row">
          <span class="label">Categoría:</span>
          <span class="value">{{producto.categoria.nombre}}</span>
        </div>

        <div class="info-row">
          <span class="label">Marca:</span>
          <span class="value">{{producto.marca.nombre}}</span>
        </div>

        <div class="info-row">
          <span class="label">Proveedor:</span>
          <span class="value">{{producto.proveedor.nombre}}</span>
        </div>
      </div>

      <!-- Precios -->
      <div class="producto-precios">
        <div class="precio-venta">
          <span class="label">Precio Venta:</span>
          <span class="value">S/ {{producto.precio | number:'1.2-2'}}</span>
        </div>
        <div class="precio-compra">
          <span class="label">Precio Compra:</span>
          <span class="value">S/ {{producto.precioCompra | number:'1.2-2'}}</span>
        </div>
      </div>

      <!-- Stock -->
      <div class="producto-stock">
        <div class="stock-info">
          <span class="label">Stock:</span>
          <span
            class="stock-value"
            [ngClass]="getStockClass(producto.stock, producto.stockMinimo)">
            {{producto.stock}}
          </span>
          <span class="stock-min">(Mín: {{producto.stockMinimo}})</span>
        </div>
        <div class="stock-status">
          <span
            class="status-badge"
            [ngClass]="getStockClass(producto.stock, producto.stockMinimo)">
            {{getStockText(producto.stock, producto.stockMinimo)}}
          </span>
        </div>
      </div>

      <!-- Acciones -->
      <div class="producto-actions">
        <button
          type="button"
          class="btn btn-sm btn-outline-primary"
          (click)="$event.stopPropagation()">
          <i class="fas fa-eye"></i> Ver
        </button>
        <button
          type="button"
          class="btn btn-sm btn-outline-warning"
          (click)="$event.stopPropagation()">
          <i class="fas fa-edit"></i> Editar
        </button>
        <button
          type="button"
          class="btn btn-sm btn-outline-info"
          (click)="$event.stopPropagation()">
          <i class="fas fa-warehouse"></i> Stock
        </button>
      </div>
    </div>
  </div>

  <!-- No hay productos -->
  <div class="no-products" *ngIf="!loading && productos.length === 0">
    <div class="no-products-content">
      <i class="fas fa-box-open"></i>
      <h3>No hay productos</h3>
      <p>No se encontraron productos con los filtros aplicados.</p>
      <button
        type="button"
        (click)="onLimpiarFiltros()"
        class="btn btn-primary">
        <i class="fas fa-refresh"></i> Limpiar Filtros
      </button>
    </div>
  </div>

  <!-- Paginación -->
  <div class="pagination-container" *ngIf="!loading && totalPages > 1">
    <div class="pagination-info">
      <span>
        Mostrando {{currentPage * pageSize + 1}} -
        {{Math.min((currentPage + 1) * pageSize, totalElements)}}
        de {{totalElements}} productos
      </span>
    </div>

    <div class="pagination">
      <button
        type="button"
        (click)="onPageChange(0)"
        [disabled]="!hasPreviousPage"
        class="btn btn-sm btn-outline-primary">
        <i class="fas fa-angle-double-left"></i>
      </button>

      <button
        type="button"
        (click)="onPageChange(currentPage - 1)"
        [disabled]="!hasPreviousPage"
        class="btn btn-sm btn-outline-primary">
        <i class="fas fa-angle-left"></i>
      </button>

      <button
        *ngFor="let page of pages"
        type="button"
        (click)="onPageChange(page)"
        [class.active]="page === currentPage"
        class="btn btn-sm btn-outline-primary">
        {{page + 1}}
      </button>

      <button
        type="button"
        (click)="onPageChange(currentPage + 1)"
        [disabled]="!hasNextPage"
        class="btn btn-sm btn-outline-primary">
        <i class="fas fa-angle-right"></i>
      </button>

      <button
        type="button"
        (click)="onPageChange(totalPages - 1)"
        [disabled]="!hasNextPage"
        class="btn btn-sm btn-outline-primary">
        <i class="fas fa-angle-double-right"></i>
      </button>
    </div>
  </div>
</div>
